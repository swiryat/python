import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Загружаем данные
file_path = "C:\\Users\\swer\\Downloads\\teset\\f1.xlsx"
df = pd.read_excel(file_path)

# Переименование столбцов с более понятными названиями
df.columns = ['Пол', 'Возрастная категория', 'Продукт 1', 'Продукт 2', 'Продукт 3',
              'Продукт 4', 'Продукт 5', 'Продукт 6', 'Продукт 7', 'Продукт 8',
              'Продукт 9', 'Продукт 10', 'Продукт 11', 'Продукт 12',
              'Продукт 13', 'Продукт 14', 'Продукт 15', 'Продукт 16',
              'Продукт 17', 'Продукт 18', 'Продукт 19', 'Продукт 20']

# Очистка данных: удаляем строки с отсутствующими значениями в столбцах 'Пол' и 'Возрастная категория'
df_cleaned = df.dropna(subset=['Пол', 'Возрастная категория'])

# Преобразуем столбцы с продуктами в числовой формат
df_cleaned.loc[:, 'Продукт 1':'Продукт 4'] = df_cleaned.loc[:, 'Продукт 1':'Продукт 4'].apply(pd.to_numeric, errors='coerce')

# Построим график с улучшенными подписями и более понятными названиями
plt.figure(figsize=(14, 8))  # Увеличим размер графика для лучшего восприятия

# График
sns.barplot(x='Пол', y='Продукт 1', data=df_cleaned, palette='Blues')

# Заголовок графика
plt.title('Распределение по продукту 1 среди мужчин и женщин', fontsize=18)

# Подписи осей
plt.xlabel('Пол', fontsize=14)
plt.ylabel('Процент (%)', fontsize=14)

# Поворот меток на оси X для лучшего восприятия
plt.xticks(rotation=0, ha='center', fontsize=12)  # Убираем поворот, если метки короткие

# Увеличиваем расстояние между метками на оси X
plt.subplots_adjust(bottom=0.15)

# Улучшаем макет, чтобы все элементы были правильно расположены
plt.tight_layout()

# Покажем график
plt.show()
